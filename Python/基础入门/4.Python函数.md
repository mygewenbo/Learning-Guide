# Python函数

## 一、函数概述

函数是组织好的、可重复使用的、用来实现特定功能的代码块。函数可以提高代码的复用性和可维护性，使代码更加模块化和结构化。

在Python中，函数分为内置函数和自定义函数：
- **内置函数**：Python提供的现成函数，如`print()`、`len()`、`range()`等
- **自定义函数**：用户根据需要自己定义的函数

## 二、函数定义与调用

### 2.1 函数定义

使用`def`关键字定义函数，基本语法如下：

```python
def 函数名(参数1, 参数2, ...):
    """文档字符串：描述函数的功能、参数和返回值"""
    # 函数体：实现函数功能的代码
    代码1
    代码2
    ...
    # 返回值（可选）
    return 返回值
```

#### 2.1.1 示例

```python
# 定义一个简单的函数，用于计算两个数的和
def add(a, b):
    """计算两个数的和
    
    参数：
        a: 第一个数
        b: 第二个数
    
    返回值：
        两个数的和
    """
    result = a + b
    return result

# 定义一个没有返回值的函数
def greet(name):
    """向指定的人打招呼
    
    参数：
        name: 要打招呼的人的名字
    """
    print(f"Hello, {name}!")
```

### 2.2 函数调用

函数定义后，需要调用才能执行。调用函数时，需要提供函数所需的参数。

#### 2.2.1 示例

```python
# 调用add函数，计算1+2的和
result = add(1, 2)
print(result)  # 输出：3

# 调用greet函数，向Alice打招呼
greet("Alice")  # 输出：Hello, Alice!
```

### 2.3 文档字符串

文档字符串（docstring）是函数定义中的第一个字符串，用于描述函数的功能、参数和返回值。可以使用`help()`函数或`.__doc__`属性查看函数的文档字符串。

#### 2.3.1 示例

```python
# 使用help()函数查看add函数的文档字符串
help(add)

# 使用.__doc__属性查看add函数的文档字符串
print(add.__doc__)
```

## 三、参数传递

Python函数支持多种参数传递方式，包括位置参数、关键字参数、默认参数、可变参数和关键字可变参数。

### 3.1 位置参数

位置参数是最常用的参数类型，调用函数时，参数的顺序必须与函数定义中的顺序一致。

#### 3.1.1 示例

```python
def greet(name, message):
    """向指定的人发送指定的消息
    
    参数：
        name: 要发送消息的人的名字
        message: 要发送的消息
    """
    print(f"{name}, {message}!")

# 调用greet函数，使用位置参数
greet("Alice", "good morning")  # 输出：Alice, good morning!
# greet("good morning", "Alice")  # 输出：good morning, Alice!（顺序错误）
```

### 3.2 关键字参数

关键字参数允许在调用函数时，通过参数名指定参数值，这样可以不考虑参数的顺序。

#### 3.2.1 示例

```python
def greet(name, message):
    """向指定的人发送指定的消息
    
    参数：
        name: 要发送消息的人的名字
        message: 要发送的消息
    """
    print(f"{name}, {message}!")

# 调用greet函数，使用关键字参数
greet(name="Alice", message="good morning")  # 输出：Alice, good morning!
greet(message="good morning", name="Alice")  # 输出：Alice, good morning!（顺序无关）
```

### 3.3 默认参数

默认参数允许在函数定义时，为参数指定默认值。调用函数时，如果不提供该参数，则使用默认值。

#### 3.3.1 示例

```python
def greet(name, message="hello"):
    """向指定的人发送消息，默认消息为hello
    
    参数：
        name: 要发送消息的人的名字
        message: 要发送的消息，默认值为hello
    """
    print(f"{name}, {message}!")

# 调用greet函数，不提供message参数，使用默认值
greet("Alice")  # 输出：Alice, hello!

# 调用greet函数，提供message参数，覆盖默认值
greet("Alice", "good morning")  # 输出：Alice, good morning!

# 调用greet函数，使用关键字参数覆盖默认值
greet("Alice", message="good afternoon")  # 输出：Alice, good afternoon!
```

#### 3.3.2 注意事项

- 默认参数必须放在位置参数之后
- 默认参数应该使用不可变类型（如数字、字符串、元组），不要使用可变类型（如列表、字典）

```python
# 错误示例：默认参数使用可变类型
def add_item(item, items=[]):
    items.append(item)
    return items

print(add_item(1))  # 输出：[1]
print(add_item(2))  # 输出：[1, 2]（意外结果，因为默认参数是可变类型）

# 正确示例：默认参数使用不可变类型
def add_item(item, items=None):
    if items is None:
        items = []
    items.append(item)
    return items

print(add_item(1))  # 输出：[1]
print(add_item(2))  # 输出：[2]（预期结果）
```

### 3.4 可变参数

可变参数允许函数接收任意数量的位置参数，这些参数会被打包成一个元组。在参数名前加上`*`表示可变参数。

#### 3.4.1 示例

```python
def sum_numbers(*numbers):
    """计算任意数量数字的和
    
    参数：
        *numbers: 任意数量的数字
    
    返回值：
        所有数字的和
    """
    total = 0
    for number in numbers:
        total += number
    return total

# 调用sum_numbers函数，传递任意数量的参数
print(sum_numbers(1, 2, 3))  # 输出：6
print(sum_numbers(1, 2, 3, 4, 5))  # 输出：15
print(sum_numbers())  # 输出：0（没有传递参数）

# 将列表中的元素作为可变参数传递
numbers = [1, 2, 3, 4, 5]
print(sum_numbers(*numbers))  # 输出：15（使用*解包列表）

# 将元组中的元素作为可变参数传递
numbers_tuple = (1, 2, 3, 4, 5)
print(sum_numbers(*numbers_tuple))  # 输出：15（使用*解包元组）
```

### 3.5 关键字可变参数

关键字可变参数允许函数接收任意数量的关键字参数，这些参数会被打包成一个字典。在参数名前加上`**`表示关键字可变参数。

#### 3.5.1 示例

```python
def print_person_info(**info):
    """打印个人信息
    
    参数：
        **info: 任意数量的关键字参数，包含个人信息
    """
    for key, value in info.items():
        print(f"{key}: {value}")

# 调用print_person_info函数，传递任意数量的关键字参数
print_person_info(name="Alice", age=25, city="New York")
# 输出：
# name: Alice
# age: 25
# city: New York

print_person_info(name="Bob", age=30)  # 输出：name: Bob, age: 30

# 将字典中的键值对作为关键字可变参数传递
person = {"name": "Charlie", "age": 35, "city": "London"}
print_person_info(**person)  # 输出：name: Charlie, age: 35, city: London（使用**解包字典）
```

### 3.6 参数组合

在Python函数中，可以组合使用多种参数类型，但参数的顺序必须是：
1. 位置参数
2. 默认参数
3. 可变参数
4. 关键字可变参数

#### 3.6.1 示例

```python
def func(a, b, c=0, *args, **kwargs):
    """示例函数，演示参数组合
    
    参数：
        a: 位置参数
        b: 位置参数
        c: 默认参数，默认值为0
        *args: 可变参数
        **kwargs: 关键字可变参数
    """
    print(f"a: {a}, b: {b}, c: {c}")
    print(f"args: {args}")
    print(f"kwargs: {kwargs}")

# 调用func函数
func(1, 2)  # 输出：a: 1, b: 2, c: 0, args: (), kwargs: {}
func(1, 2, 3)  # 输出：a: 1, b: 2, c: 3, args: (), kwargs: {}
func(1, 2, 3, 4, 5)  # 输出：a: 1, b: 2, c: 3, args: (4, 5), kwargs: {}
func(1, 2, 3, 4, 5, x=6, y=7)  # 输出：a: 1, b: 2, c: 3, args: (4, 5), kwargs: {'x': 6, 'y': 7}
func(1, 2, x=6, y=7)  # 输出：a: 1, b: 2, c: 0, args: (), kwargs: {'x': 6, 'y': 7}
```

## 四、返回值

函数可以使用`return`语句返回一个或多个值。如果函数没有`return`语句，或者`return`语句后没有值，则函数返回`None`。

### 4.1 返回单个值

#### 4.1.1 示例

```python
def add(a, b):
    """计算两个数的和
    
    参数：
        a: 第一个数
        b: 第二个数
    
    返回值：
        两个数的和
    """
    return a + b

result = add(1, 2)
print(result)  # 输出：3
```

### 4.2 返回多个值

函数可以返回多个值，这些值会被打包成一个元组。

#### 4.2.1 示例

```python
def get_person_info():
    """获取个人信息
    
    返回值：
        姓名、年龄、城市，打包成一个元组
    """
    name = "Alice"
    age = 25
    city = "New York"
    return name, age, city  # 相当于return (name, age, city)

# 接收多个返回值，使用元组解包
name, age, city = get_person_info()
print(name)  # 输出：Alice
print(age)  # 输出：25
print(city)  # 输出：New York

# 接收多个返回值，使用单个变量存储（元组）
person_info = get_person_info()
print(person_info)  # 输出：('Alice', 25, 'New York')
print(type(person_info))  # 输出：<class 'tuple'>
```

### 4.3 提前返回

`return`语句会立即结束函数的执行，返回到调用者。

#### 4.3.1 示例

```python
def is_even(number):
    """判断一个数是否为偶数
    
    参数：
        number: 要判断的数
    
    返回值：
        如果是偶数，返回True；否则，返回False
    """
    if number % 2 == 0:
        return True  # 提前返回
    return False

print(is_even(2))  # 输出：True
print(is_even(3))  # 输出：False
```

## 五、作用域与命名空间

### 5.1 作用域

作用域是变量的可见范围，即变量在哪些位置可以被访问。Python中有四种作用域：

1. **局部作用域（Local）**：在函数内部定义的变量，只能在函数内部访问
2. **嵌套作用域（Enclosing）**：在嵌套函数中，外层函数的变量可以被内层函数访问
3. **全局作用域（Global）**：在模块级别定义的变量，可以在模块内的任何位置访问
4. **内置作用域（Built-in）**：Python内置的变量和函数，如`print()`、`len()`等

#### 5.1.1 示例

```python
# 全局变量
x = 10

def outer():
    # 嵌套变量
    y = 20
    
    def inner():
        # 局部变量
        z = 30
        print(f"inner函数中：x={x}, y={y}, z={z}")  # 可以访问全局变量、嵌套变量和局部变量
    
    inner()
    print(f"outer函数中：x={x}, y={y}")  # 可以访问全局变量和嵌套变量
    # print(f"outer函数中：z={z}")  # 无法访问inner函数的局部变量，会抛出NameError异常

outer()
print(f"全局作用域中：x={x}")  # 可以访问全局变量
# print(f"全局作用域中：y={y}")  # 无法访问outer函数的嵌套变量，会抛出NameError异常
# print(f"全局作用域中：z={z}")  # 无法访问inner函数的局部变量，会抛出NameError异常
```

### 5.2 变量查找规则

当访问一个变量时，Python会按照LEGB规则查找变量：
1. **L（Local）**：首先在当前函数的局部作用域中查找
2. **E（Enclosing）**：如果在局部作用域中没有找到，就在嵌套作用域中查找
3. **G（Global）**：如果在嵌套作用域中没有找到，就在全局作用域中查找
4. **B（Built-in）**：如果在全局作用域中没有找到，就在内置作用域中查找

如果在所有作用域中都没有找到变量，就会抛出`NameError`异常。

#### 5.2.1 示例

```python
# 内置函数len
print(len([1, 2, 3]))  # 输出：3

# 全局变量len
def test():
    # 局部变量len
    len = 10
    print(len)  # 输出：10（局部作用域）

test()
print(len)  # 输出：<built-in function len>（内置作用域）
```

### 5.3 global关键字

`global`关键字用于在函数内部访问和修改全局变量。

#### 5.3.1 示例

```python
# 全局变量
x = 10

def modify_global():
    # 声明x是全局变量
    global x
    x = 20  # 修改全局变量
    print(f"函数内部：x={x}")

modify_global()
print(f"函数外部：x={x}")  # 输出：20（全局变量被修改）
```

### 5.4 nonlocal关键字

`nonlocal`关键字用于在嵌套函数内部访问和修改外层函数的变量。

#### 5.4.1 示例

```python
def outer():
    # 嵌套变量
    y = 20
    
    def inner():
        # 声明y是外层函数的变量
        nonlocal y
        y = 30  # 修改外层函数的变量
        print(f"inner函数中：y={y}")
    
    inner()
    print(f"outer函数中：y={y}")  # 输出：30（外层函数的变量被修改）

outer()
```

### 5.5 命名空间

命名空间是变量名到对象的映射，用于存储变量和它们的值。每个作用域都有自己的命名空间。

- **内置命名空间**：存储Python内置的变量和函数
- **全局命名空间**：存储模块级别的变量和函数
- **局部命名空间**：存储函数内部的变量和参数

#### 5.5.1 示例

```python
# 全局命名空间
x = 10

def func(a, b):
    # 局部命名空间
    c = a + b
    return c

print(globals())  # 查看全局命名空间
print(locals())  # 查看当前命名空间（全局命名空间）

# 在函数内部查看局部命名空间
def func_with_namespace(a, b):
    c = a + b
    print("局部命名空间：", locals())
    return c

func_with_namespace(1, 2)  # 输出：局部命名空间： {'a': 1, 'b': 2, 'c': 3}
```

## 六、函数的高级特性

### 6.1 嵌套函数

嵌套函数是指在一个函数内部定义另一个函数。

#### 6.1.1 示例

```python
def outer():
    """外层函数"""
    print("这是外层函数")
    
    def inner():
        """内层函数"""
        print("这是内层函数")
    
    inner()  # 调用内层函数

outer()  # 输出：这是外层函数，这是内层函数
# inner()  # 无法在外部调用内层函数，会抛出NameError异常
```

### 6.2 闭包

闭包是指内层函数引用了外层函数的变量，并且内层函数被返回或传递到外部，这样外层函数的变量会被保留。

#### 6.2.1 示例

```python
def make_counter():
    """创建一个计数器函数
    
    返回值：
        一个计数器函数，每次调用返回递增的整数
    """
    count = 0  # 外层函数的变量
    
    def counter():
        """计数器函数"""
        nonlocal count  # 声明count是外层函数的变量
        count += 1
        return count
    
    return counter  # 返回内层函数

# 创建计数器函数
counter1 = make_counter()
counter2 = make_counter()

# 调用计数器函数
print(counter1())  # 输出：1
print(counter1())  # 输出：2
print(counter1())  # 输出：3

print(counter2())  # 输出：1（独立的计数器）
print(counter2())  # 输出：2
```

### 6.3 匿名函数（lambda）

匿名函数是指没有名字的函数，使用`lambda`关键字定义，语法简洁，适合定义简单的函数。

#### 6.3.1 基本语法

```python
lambda 参数1, 参数2, ...: 表达式
```

#### 6.3.2 示例

```python
# 定义匿名函数，计算两个数的和
sum = lambda a, b: a + b
print(sum(1, 2))  # 输出：3

# 定义匿名函数，判断一个数是否为偶数
is_even = lambda x: x % 2 == 0
print(is_even(2))  # 输出：True
print(is_even(3))  # 输出：False

# 在高阶函数中使用匿名函数
numbers = [1, 2, 3, 4, 5]
# 使用map函数和匿名函数，计算列表中每个元素的平方
squares = list(map(lambda x: x**2, numbers))
print(squares)  # 输出：[1, 4, 9, 16, 25]

# 使用filter函数和匿名函数，过滤列表中的偶数
evens = list(filter(lambda x: x % 2 == 0, numbers))
print(evens)  # 输出：[2, 4]

# 使用sorted函数和匿名函数，根据字典的value排序
dict_list = [{"name": "Alice", "age": 25}, {"name": "Bob", "age": 30}, {"name": "Charlie", "age": 20}]
sorted_dict_list = sorted(dict_list, key=lambda x: x["age"])
print(sorted_dict_list)  # 输出：[{'name': 'Charlie', 'age': 20}, {'name': 'Alice', 'age': 25}, {'name': 'Bob', 'age': 30}]
```

### 6.4 高阶函数

高阶函数是指接受一个或多个函数作为参数，或者返回一个函数的函数。

#### 6.4.1 示例

```python
# 定义一个高阶函数，接受一个函数和一个列表作为参数
def apply_func(func, numbers):
    """将函数应用到列表中的每个元素
    
    参数：
        func: 要应用的函数
        numbers: 要处理的列表
    
    返回值：
        处理后的列表
    """
    result = []
    for number in numbers:
        result.append(func(number))
    return result

# 定义一个函数，计算平方
def square(x):
    return x**2

# 定义一个函数，计算立方
def cube(x):
    return x**3

numbers = [1, 2, 3, 4, 5]

# 调用高阶函数，传递square函数
squares = apply_func(square, numbers)
print(squares)  # 输出：[1, 4, 9, 16, 25]

# 调用高阶函数，传递cube函数
cubes = apply_func(cube, numbers)
print(cubes)  # 输出：[1, 8, 27, 64, 125]

# 调用高阶函数，传递匿名函数
doubles = apply_func(lambda x: x * 2, numbers)
print(doubles)  # 输出：[2, 4, 6, 8, 10]
```

### 6.5 递归函数

递归函数是指调用自身的函数。递归函数通常用于解决可以分解为相同子问题的问题，如阶乘、斐波那契数列等。

#### 6.5.1 示例：阶乘

```python
def factorial(n):
    """计算n的阶乘
    
    参数：
        n: 非负整数
    
    返回值：
        n的阶乘
    """
    if n == 0 or n == 1:  # 基线条件
        return 1
    return n * factorial(n - 1)  # 递归调用

print(factorial(5))  # 输出：120（5! = 5 × 4 × 3 × 2 × 1 = 120）
print(factorial(10))  # 输出：3628800
```

#### 6.5.2 示例：斐波那契数列

```python
def fibonacci(n):
    """计算斐波那契数列的第n项
    
    参数：
        n: 正整数
    
    返回值：
        斐波那契数列的第n项
    """
    if n == 1 or n == 2:  # 基线条件
        return 1
    return fibonacci(n - 1) + fibonacci(n - 2)  # 递归调用

print(fibonacci(5))  # 输出：5（斐波那契数列：1, 1, 2, 3, 5）
print(fibonacci(10))  # 输出：55
```

#### 6.5.3 注意事项

- 递归函数必须有基线条件（终止条件），否则会导致无限递归
- 递归函数的调用深度有限制，Python默认的递归深度限制是1000
- 递归函数的效率可能较低，对于大规模问题，建议使用迭代或动态规划

## 七、函数式编程

Python支持函数式编程，主要包括以下特性：

### 7.1 map函数

`map()`函数将一个函数应用到可迭代对象的每个元素上，返回一个迭代器。

#### 7.1.1 示例

```python
numbers = [1, 2, 3, 4, 5]

# 使用map函数计算列表中每个元素的平方
squares = map(lambda x: x**2, numbers)
print(list(squares))  # 输出：[1, 4, 9, 16, 25]

# 使用map函数将列表中的字符串转换为整数
strings = ["1", "2", "3", "4", "5"]
numbers = map(int, strings)
print(list(numbers))  # 输出：[1, 2, 3, 4, 5]

# 使用map函数处理多个可迭代对象
numbers1 = [1, 2, 3]
numbers2 = [4, 5, 6]
sums = map(lambda x, y: x + y, numbers1, numbers2)
print(list(sums))  # 输出：[5, 7, 9]
```

### 7.2 filter函数

`filter()`函数使用一个函数过滤可迭代对象的元素，返回一个迭代器，包含函数返回True的元素。

#### 7.2.1 示例

```python
numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

# 使用filter函数过滤列表中的偶数
evens = filter(lambda x: x % 2 == 0, numbers)
print(list(evens))  # 输出：[2, 4, 6, 8, 10]

# 使用filter函数过滤列表中的奇数
odds = filter(lambda x: x % 2 != 0, numbers)
print(list(odds))  # 输出：[1, 3, 5, 7, 9]

# 使用filter函数过滤列表中的正数
numbers = [-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5]
positives = filter(lambda x: x > 0, numbers)
print(list(positives))  # 输出：[1, 2, 3, 4, 5]
```

### 7.3 reduce函数

`reduce()`函数将一个函数应用到可迭代对象的元素上，从左到右累积计算，返回一个值。需要从`functools`模块导入。

#### 7.3.1 示例

```python
from functools import reduce

numbers = [1, 2, 3, 4, 5]

# 使用reduce函数计算列表中所有元素的和
sum = reduce(lambda x, y: x + y, numbers)
print(sum)  # 输出：15

# 使用reduce函数计算列表中所有元素的乘积
product = reduce(lambda x, y: x * y, numbers)
print(product)  # 输出：120

# 使用reduce函数计算列表中的最大值
max_value = reduce(lambda x, y: x if x > y else y, numbers)
print(max_value)  # 输出：5
```

### 7.4 sorted函数

`sorted()`函数对可迭代对象进行排序，返回一个新的列表。可以使用`key`参数指定排序规则。

#### 7.4.1 示例

```python
numbers = [3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5]

# 对列表进行升序排序
sorted_numbers = sorted(numbers)
print(sorted_numbers)  # 输出：[1, 1, 2, 3, 3, 4, 5, 5, 5, 6, 9]

# 对列表进行降序排序
sorted_numbers_reverse = sorted(numbers, reverse=True)
print(sorted_numbers_reverse)  # 输出：[9, 6, 5, 5, 5, 4, 3, 3, 2, 1, 1]

# 对字符串列表进行排序
strings = ["apple", "banana", "orange", "grape"]
sorted_strings = sorted(strings)
print(sorted_strings)  # 输出：['apple', 'banana', 'grape', 'orange']

# 对字符串列表按长度排序
sorted_strings_by_length = sorted(strings, key=lambda x: len(x))
print(sorted_strings_by_length)  # 输出：['apple', 'grape', 'banana', 'orange']

# 对字典列表按年龄排序
dict_list = [{"name": "Alice", "age": 25}, {"name": "Bob", "age": 30}, {"name": "Charlie", "age": 20}]
sorted_dict_list = sorted(dict_list, key=lambda x: x["age"])
print(sorted_dict_list)  # 输出：[{'name': 'Charlie', 'age': 20}, {'name': 'Alice', 'age': 25}, {'name': 'Bob', 'age': 30}]
```

## 八、综合示例

### 8.1 计算器函数

```python
def calculator(a, b, operator):
    """简单计算器函数
    
    参数：
        a: 第一个操作数
        b: 第二个操作数
        operator: 运算符，支持+、-、*、/
    
    返回值：
        计算结果
    """
    if operator == "+":
        return a + b
    elif operator == "-":
        return a - b
    elif operator == "*":
        return a * b
    elif operator == "/":
        if b == 0:
            return "除数不能为0"
        return a / b
    else:
        return "不支持的运算符"

# 测试计算器函数
print(calculator(1, 2, "+"))  # 输出：3
print(calculator(5, 2, "-"))  # 输出：3
print(calculator(3, 4, "*"))  # 输出：12
print(calculator(10, 2, "/"))  # 输出：5.0
print(calculator(10, 0, "/"))  # 输出：除数不能为0
print(calculator(1, 2, "%"))  # 输出：不支持的运算符
```

### 8.2 素数判断函数

```python
def is_prime(n):
    """判断一个数是否为素数
    
    参数：
        n: 要判断的数
    
    返回值：
        如果是素数，返回True；否则，返回False
    """
    if n <= 1:
        return False
    for i in range(2, int(n**0.5) + 1):
        if n % i == 0:
            return False
    return True

def get_primes(start, end):
    """获取指定范围内的所有素数
    
    参数：
        start: 范围的起始值
        end: 范围的结束值
    
    返回值：
        包含所有素数的列表
    """
    primes = []
    for i in range(start, end + 1):
        if is_prime(i):
            primes.append(i)
    return primes

# 测试素数判断函数
print(is_prime(2))  # 输出：True
print(is_prime(3))  # 输出：True
print(is_prime(4))  # 输出：False
print(is_prime(17))  # 输出：True

# 测试获取素数函数
print(get_primes(1, 20))  # 输出：[2, 3, 5, 7, 11, 13, 17, 19]
print(get_primes(100, 150))  # 输出：[101, 103, 107, 109, 113, 127, 131, 137, 139, 149]
```

## 九、常见问题与解决方案

### 9.1 函数名重复

- **问题**：定义了与内置函数或其他函数同名的函数
- **解决方案**：避免使用内置函数名作为自定义函数名，使用更具描述性的函数名

```python
# 错误示例：函数名与内置函数同名
def len(numbers):
    count = 0
    for number in numbers:
        count += 1
    return count

# print(len([1, 2, 3]))  # 调用自定义的len函数，输出：3
# print(len("hello"))  # 调用自定义的len函数，会抛出TypeError异常

# 正确示例：使用更具描述性的函数名
def get_length(numbers):
    count = 0
    for number in numbers:
        count += 1
    return count

print(get_length([1, 2, 3]))  # 输出：3
print(len("hello"))  # 调用内置的len函数，输出：5
```

### 9.2 忘记return语句

- **问题**：函数应该返回值，但忘记了return语句
- **解决方案**：确保函数在所有路径上都有return语句

```python
# 错误示例：忘记return语句
def add(a, b):
    result = a + b
    # 忘记return语句

result = add(1, 2)
print(result)  # 输出：None

# 正确示例：添加return语句
def add(a, b):
    result = a + b
    return result

result = add(1, 2)
print(result)  # 输出：3
```

### 9.3 可变参数的修改

- **问题**：在函数内部修改了可变参数（如列表、字典），导致外部的可变参数也被修改
- **解决方案**：如果不希望修改外部的可变参数，可以在函数内部创建一个副本

```python
# 示例：修改可变参数
def append_item(item, items):
    items.append(item)  # 修改了外部的列表
    return items

numbers = [1, 2, 3]
result = append_item(4, numbers)
print(result)  # 输出：[1, 2, 3, 4]
print(numbers)  # 输出：[1, 2, 3, 4]（外部列表被修改）

# 解决方案：创建副本
def append_item_safe(item, items):
    new_items = items.copy()  # 创建副本
    new_items.append(item)
    return new_items

numbers = [1, 2, 3]
result = append_item_safe(4, numbers)
print(result)  # 输出：[1, 2, 3, 4]
print(numbers)  # 输出：[1, 2, 3]（外部列表未被修改）
```

## 十、总结

本章介绍了Python函数的相关知识，包括：

1. **函数概述**：介绍了函数的定义和分类
2. **函数定义与调用**：详细讲解了函数的定义、调用和文档字符串
3. **参数传递**：包括位置参数、关键字参数、默认参数、可变参数和关键字可变参数
4. **返回值**：介绍了返回单个值、多个值和提前返回
5. **作用域与命名空间**：详细讲解了作用域、变量查找规则、global关键字、nonlocal关键字和命名空间
6. **函数的高级特性**：包括嵌套函数、闭包、匿名函数、高阶函数和递归函数
7. **函数式编程**：介绍了map、filter、reduce和sorted等函数式编程工具
8. **综合示例**：包括计算器函数和素数判断函数两个综合示例
9. **常见问题与解决方案**：列出了初学者常见的问题和解决方法

通过本章的学习，你应该已经掌握了Python函数的相关知识，可以编写更复杂、更模块化的Python程序了。接下来，我们将学习Python的字符串与正则表达式。

## 十一、练习

1. 编写一个Python函数，计算两个数的乘积。
2. 编写一个Python函数，判断一个字符串是否为回文。
3. 编写一个Python函数，接收任意数量的参数，返回它们的最大值。
4. 编写一个Python函数，接收一个列表和一个函数作为参数，将函数应用到列表中的每个元素上，返回处理后的列表。
5. 编写一个Python函数，使用递归计算斐波那契数列的第n项。
6. 编写一个Python函数，使用闭包创建一个计数器函数。
7. 编写一个Python函数，使用map和lambda函数将列表中的字符串转换为大写。
8. 编写一个Python函数，使用filter和lambda函数过滤列表中的负数。
9. 编写一个Python函数，使用reduce函数计算列表中所有元素的和。
10. 编写一个Python函数，接收一个字典列表，按照指定的键进行排序。

## 十二、参考资料

1. Python官方文档：https://docs.python.org/zh-cn/3/tutorial/controlflow.html#defining-functions
2. 《Python编程：从入门到实践》（Eric Matthes）
3. 《流畅的Python》（Luciano Ramalho）
4. 《Python核心编程》（Wesley Chun）